<Window x:Class="SolusManifestApp.Tools.SteamAuthPro.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="⚙️ Settings"
        Height="650"
        Width="650"
        WindowStyle="None"
        AllowsTransparency="False"
        Background="{DynamicResource SteamDarkBrush}"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterOwner">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40"
                      ResizeBorderThickness="0"
                      GlassFrameThickness="0"
                      CornerRadius="0"/>
    </WindowChrome.WindowChrome>

    <Border BorderBrush="{DynamicResource SteamMediumBrush}" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Custom Title Bar -->
            <Grid Grid.Row="0" Background="{DynamicResource SteamDarkestBrush}" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <StackPanel Orientation="Horizontal" Margin="10,0,0,0" VerticalAlignment="Center">
                    <TextBlock Text="⚙️ Settings" FontSize="13" FontWeight="Bold" Foreground="{DynamicResource SteamLightBrush}"/>
                </StackPanel>

                <StackPanel HorizontalAlignment="Right" Orientation="Horizontal" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button Content="✕" Width="40" Height="40" Click="CloseButton_Click" Style="{DynamicResource CloseButtonStyle}"/>
                </StackPanel>
            </Grid>

            <!-- Content -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="15">
                    <!-- Accounts Section -->
                    <GroupBox Header="Accounts" Margin="0,0,0,8" Style="{DynamicResource SteamGroupBoxStyle}">
                        <StackPanel Margin="8">
                            <ListBox x:Name="AccountsListBox" MaxHeight="120" Margin="0,0,0,8"
                                     Background="{DynamicResource SteamMediumBrush}"
                                     Foreground="{DynamicResource SteamTextBrush}"
                                     BorderBrush="{DynamicResource SteamDarkBrush}"/>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button Content="Auto-Detect" Width="120" Margin="5" Click="AutoDetectButton_Click" Style="{DynamicResource SteamButtonStyle}"/>
                                <Button Content="Add Account" Width="120" Margin="5" Click="AddAccountButton_Click" Style="{DynamicResource SteamButtonStyle}"/>
                                <Button Content="Remove" Width="120" Margin="5" Click="RemoveAccountButton_Click" Style="{DynamicResource SteamButtonStyle}"/>
                                <Button Content="Set Active" Width="120" Margin="5" Click="SetActiveButton_Click" Style="{DynamicResource SteamButtonStyle}"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <!-- API Configuration -->
                    <GroupBox Header="API Configuration" Style="{DynamicResource SteamGroupBoxStyle}">
                        <StackPanel Margin="8">
                            <Label Content="API URL:" Foreground="{DynamicResource SteamTextBrush}"/>
                            <TextBox x:Name="ApiUrlTextBox" Style="{DynamicResource SteamTextBoxStyle}" Margin="0,0,0,8"/>

                            <Label Content="PHPSESSID:" Foreground="{DynamicResource SteamTextBrush}"/>
                            <TextBox x:Name="PhpSessionIdTextBox" Style="{DynamicResource SteamTextBoxStyle}" Margin="0,0,0,8"/>

                            <TextBlock TextWrapping="Wrap" Foreground="#8f98a0" FontSize="10" Margin="0,5,0,0">
                                To get PHPSESSID:
                                <LineBreak/>1. Open browser DevTools (F12)
                                <LineBreak/>2. Go to https://drm.steam.run
                                <LineBreak/>3. Check Application → Cookies → PHPSESSID
                            </TextBlock>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </ScrollViewer>

            <!-- Buttons -->
            <Grid Grid.Row="2" Background="{DynamicResource SteamDarkBrush}" Margin="0,10,0,0">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="20">
                    <Button Content="Save" Width="100" Margin="5" Click="SaveButton_Click" Style="{DynamicResource SteamButtonStyle}"/>
                    <Button Content="Cancel" Width="100" Margin="5" Click="CancelButton_Click" Style="{DynamicResource SteamButtonStyle}"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>
